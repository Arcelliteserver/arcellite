# ─────────────────────────────────────────────────────────────────────────────
#  Arcellite — Log Rotation Configuration
#
#  Install:  sudo cp scripts/logrotate.conf /etc/logrotate.d/arcellite
#  Test:     sudo logrotate --debug /etc/logrotate.d/arcellite
#  Force:    sudo logrotate --force /etc/logrotate.d/arcellite
# ─────────────────────────────────────────────────────────────────────────────

# ── Application logs (journald → forwarded file, backup, health) ─────────────
/home/*/.arcellite/logs/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxsize 50M
    # Re-open log files after rotation so running processes pick up new fd
    postrotate
        # Signal health-monitor (if it writes to a file handle; mostly it uses >>)
        true
    endscript
}

# ── Backup manifests (keep 30 days of rotation records) ──────────────────────
/home/*/.arcellite/backups/*/manifest.json {
    monthly
    rotate 3
    compress
    missingok
    notifempty
    copytruncate
}
